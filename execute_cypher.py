import logging
from utils import execute_cypher_query


#TODO: Handle cypher query result parsing
"""
([[<Node element_id='4:c7477355-1c31-4975-b372-a4d5eed5458b:20' labels=frozenset({'Person'}) properties={'unique_id': 'a746dec2b19944209be629e22d85b8a8', 'gender': 'F', 'surname': 'Iyer', 'embedding': [0.007511305622756481, 0.03384232148528099, -0.05154017359018326, -0.009373060427606106, -0.11371927708387375, 0.04814835637807846, 0.060722943395376205, 0.07355910539627075, -0.01799442619085312, -0.008895167149603367, -0.023677697405219078, -0.15884633362293243, -0.025016089901328087, 0.00676943501457572, -0.05218711867928505, 0.04541436955332756, -0.0010976326884701848, 0.0065182046964764595, 0.013454522006213665, 0.0038437338080257177, -0.051552899181842804, 0.012770787812769413, 0.00614240812137723, 0.027889518067240715, -0.041139159351587296, 0.01987839676439762, 0.03363634645938873, 0.0065161255188286304, -0.026830598711967468, -0.12042267620563507, 0.026053963229060173, 0.09930787235498428, 0.0816013291478157, -0.04617734253406525, -0.03239241987466812, -0.024830304086208344, -0.008338448591530323, 0.0008160067372955382, 0.10098937898874283, -0.008481192402541637, -0.07491972297430038, -0.0011740047484636307, -0.01895957626402378, -0.04040176421403885, 0.03254658356308937, -0.010032434947788715, 0.014099236577749252, 0.08860491961240768, 0.03540319576859474, 0.021911801770329475, -0.041775938123464584, 0.03404224291443825, -0.06709744781255722, 0.13023193180561066, 0.06817550212144852, -0.04218018427491188, 0.00028792076045647264, -0.018583890050649643, 0.02032475359737873, 0.07563137263059616, 0.001413828693330288, 0.03400315344333649, 0.014846640639007092, 0.06362374126911163, 0.03928723186254501, 0.046762675046920776, -0.048828911036252975, -0.026002001017332077, -0.07341265678405762, 0.05090434476733208, 0.04474978893995285, -0.05196940526366234, -0.01231890358030796, 0.010823354125022888, 0.0783211961388588, -0.002560865832492709, 0.037016283720731735, 0.047546349465847015, 0.045560840517282486, -0.05875491350889206, -0.08476964384317398, -0.09104543179273605, -0.01570849120616913, -0.032749757170677185, -0.0015708537539467216, 0.018276341259479523, -0.026452206075191498, -0.01911480911076069, 0.033096037805080414, 0.03362604230642319, 0.04175759106874466, 0.04858210310339928, 0.0022555768955498934, -0.02047501690685749, 0.005802947096526623, -0.051124442368745804, 0.0022040519397705793, 0.011981653980910778, -0.03451886400580406, 0.05957899987697601, 0.008652513846755028, -0.016337618231773376, -0.0261539276689291, 0.050476230680942535, -0.11463556438684464, -0.009007252752780914, 0.05694173276424408, -0.07304627448320389, 0.029545942321419716, 0.02732253074645996, -0.04893431067466736, 0.017626622691750526, -0.020224185660481453, -0.0770147517323494, -0.06832939386367798, -0.013558401726186275, -0.07418344914913177, 0.010745206847786903, 0.09489165246486664, -0.07491616159677505, -0.01932292990386486, 0.06048652157187462, -0.0714370608329773, 0.024560341611504555, -0.08947837352752686, -0.03909522667527199, -0.05485006794333458, -1.635673022191358e-33, -0.005973982159048319, 0.004036714788526297, 0.0650542825460434, 0.04288787022233009, 0.049788039177656174, -0.05037793144583702, -0.06672866642475128, -0.06564225256443024, -0.07886271178722382, -0.05936671793460846, -0.0038326301146298647, 0.008934184908866882, -0.04594150930643082, -0.03042779490351677, 0.04585638269782066, -0.0108476048335433, -0.023390090093016624, -0.055355168879032135, 0.021860437467694283, -0.03265610709786415, 0.06712106615304947, 0.04187752306461334, 0.03860883042216301, 0.004533958621323109, 0.05965793505311012, -0.00879255123436451, 0.10457012802362442, -0.01412383932620287, -0.0704377293586731, 0.05917874351143837, 0.007210369221866131, -0.02833748050034046, -0.0532233864068985, -0.13071087002754211, -0.06282206624746323, -0.05637286975979805, 0.01085607148706913, -0.03666273131966591, -0.09991201013326645, 0.021546831354498863, 0.012498334981501102, 0.0584687702357769, 0.04102979600429535, 0.007683954201638699, 0.02789244055747986, 0.037031389772892, 0.014384549111127853, 0.060982655733823776, 0.09069616347551346, 0.07917402684688568, -0.009713122621178627, -0.04926961660385132, -0.03849759325385094, 0.00684342160820961, -0.010617395862936974, 0.05073024705052376, 0.0048609632067382336, 0.026862651109695435, 0.02889540046453476, 0.06323682516813278, 0.049403246492147446, 0.04413345828652382, 0.0015995412832126021, 0.025212058797478676, -0.08410973101854324, -0.024573788046836853, -0.003568412270396948, 0.06569688767194748, 0.00763999717310071, -0.07677140831947327, -0.0565873384475708, -0.022724928334355354, 0.10565943270921707, 0.006952286697924137, -0.05645688623189926, 0.05699159950017929, -0.024238785728812218, -0.03795109689235687, -0.07384072244167328, -0.06139557436108589, -0.0076006618328392506, 0.025671610608696938, 0.0224168598651886, 0.000994525384157896, 0.02978973276913166, 0.018721986562013626, -0.0013878092868253589, -0.09116608649492264, -0.025461606681346893, 0.013621262274682522, -0.02460058033466339, 0.010474719107151031, 0.06867417693138123, -0.018132606521248817, -0.012697696685791016, 1.1405147613486856e-33, -0.028286006301641464, -0.057227686047554016, 0.054451845586299896, -0.019665531814098358, 0.0075594400987029076, -0.04426877945661545, 0.10177832096815109, -0.015271227806806564, 0.10399367660284042, 0.016546951606869698, -0.03400781750679016, -0.022003471851348877, 0.05331193655729294, -0.11298439651727676, -0.042010873556137085, 0.07697870582342148, 0.11276764422655106, -0.03278609365224838, 0.024046843871474266, -0.052392300218343735, 0.01110691949725151, 0.011639679782092571, 0.019719408825039864, -0.03303518146276474, -0.0664488822221756, 0.0550689697265625, 0.08691366016864777, 0.09612873196601868, 0.007551956921815872, 0.009644641540944576, 0.04261961206793785, -0.03693358227610588, -0.07424315065145493, -0.01043371856212616, -0.05116124451160431, -0.003486940637230873, 0.05416853353381157, -0.0011691814288496971, 0.0006683417013846338, -0.0055964612402021885, -0.028080496937036514, 0.0820547565817833, -0.023936929181218147, 0.09429927915334702, 0.020516717806458473, 0.035142168402671814, -0.06080238148570061, 0.019378401339054108, 0.016724765300750732, 0.03578924015164375, -0.03310554847121239, -0.02957826480269432, -0.050241876393556595, -0.04652523621916771, -0.007819081656634808, 0.010765749961137772, 0.050863102078437805, -0.043803825974464417, 0.02831261418759823, 0.009561339393258095, 0.07456833869218826, 0.07513245940208435, 0.11211343854665756, 0.0013111485168337822, 0.010528048500418663, -0.021053574979305267, -0.06056176498532295, -0.041501350700855255, 0.05543326213955879, -0.016457118093967438, 0.09432213008403778, -0.035234950482845306, -0.09347844123840332, 0.04876408353447914, -0.0740719884634018, 0.12596288323402405, -0.013259370811283588, 0.017480742186307907, -0.029964454472064972, 0.05861186236143112, -0.04230470210313797, 0.018375737592577934, -0.03824462369084358, 0.10061082243919373, 0.00047503149835392833, -0.009829830378293991, 0.035435162484645844, -0.06720741093158722, 0.11032986640930176, -0.00981383677572012, -0.0029793039429932833, 0.054086603224277496, 0.0669093057513237, -0.0646967887878418, -0.014968357048928738, -1.693965856475188e-08, -0.041392795741558075, -0.14375558495521545, -0.06594408303499222, 0.009633506648242474, 0.035287126898765564, -0.0791274905204773, -0.0676088035106659, -0.07120507210493088, 0.0094847297295928, -0.03460286185145378, 0.03191357105970383, 0.04290489852428436, 0.002023026579990983, 0.03277386352419853, 0.07318786531686783, 0.01329539343714714, 0.05576493218541145, -0.02022317238152027, -0.023191574960947037, -0.04211271554231644, -0.022393062710762024, 0.025527209043502808, 0.05100519210100174, -0.015093296766281128, -0.028228437528014183, -0.013198725879192352, -0.06037575379014015, -0.007358633913099766, 0.039585888385772705, 0.06299227476119995, -0.03389811888337135, 0.12035471200942993, 0.028403831645846367, -0.07739003002643585, -0.04016432911157608, 0.015179118141531944, -0.04300414025783539, 0.016358550637960434, -0.056536078453063965, -0.002350911498069763, 0.06464424729347229, -0.04241194203495979, 0.04293230175971985, -0.025536304339766502, 0.03487513214349747, -0.02984747290611267, -0.031075408682227135, 0.08327922970056534, 0.029544025659561157, -0.0715048536658287, -0.012519583106040955, -0.0013682690914720297, 0.03550449758768082, 0.10362423956394196, 0.04038926959037781, 0.009012714959681034, -0.07541581988334656, 0.013512968085706234, 0.07879429310560226, -0.016630912199616432, 0.10550470650196075, -0.1022142842411995, 0.026082424446940422, -0.014380118809640408], 'first_name': 'Babita'}>]], ['p1'])
"""

def execute_cypher(cypher:str):
    return execute_cypher_query(cypher)

if __name__ == "__main__":
    logging.basicConfig(level=logging.INFO)
    user_query = "Which group is Jethalal's son a part of ?"
    relevant_nodes = [('Person', {'element_id': '4:e739d468-094d-4147-891a-7dff70c687c6:2', 'first_name': 'Jethalal', 'surname': 'Gada', 'nick_name': 'Jethia', 'gender': 'M'})]
    cypher="""MATCH (p:Person {first_name: 'Jethalal'})-[:IS_PARENT_OF]-(c:Person)
OPTIONAL MATCH (c)-[:IS_PART_OF]->(g:Group)
WHERE p.gender = 'M'
RETURN g.name as group_name"""
    resp = execute_cypher(cypher=cypher)
    logging.info(resp)